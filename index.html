<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>Representación de Procesos Espectrales | Neutro</title><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,400;9..144,500;9..144,600&family=Source+Sans+3:wght@300;400;500;600&display=swap" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/chart.js"></script><style>:root{--bg-primary:#FAF7F2;--bg-secondary:#F5EFE6;--bg-tertiary:#EDE5D8;--text-primary:#2D2A26;--text-secondary:#5C5650;--text-muted:#8A8279;--accent-warm:#E30412;--accent-earth:#B50310;--accent-sage:#7D9181;--accent-deep:#6B5B4F;--border-soft:rgba(107,91,79,0.15);--shadow-soft:0 4px 20px rgba(45,42,38,0.08);--transition-smooth:all 0.4s cubic-bezier(0.4,0,0.2,1)}body{font-family:'Source Sans 3',sans-serif;background-color:var(--bg-primary);color:var(--text-primary);display:flex;flex-direction:column;align-items:center;padding:2rem;margin:0;min-height:100vh}body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");opacity:0.03;pointer-events:none;z-index:0}.app-container{position:relative;z-index:1;background:#fff;padding:2rem;border-radius:16px;box-shadow:var(--shadow-soft);border:1px solid var(--border-soft);width:100%;max-width:900px}h1{font-family:'Fraunces',serif;font-weight:500;text-align:center;color:var(--text-primary);margin-bottom:0.5rem;font-size:clamp(1.6rem,3.5vw,2.2rem);letter-spacing:-0.02em}.subtitle{text-align:center;color:var(--text-muted);font-size:0.95rem;margin-bottom:2rem}.tabs{display:flex;justify-content:center;margin-bottom:2rem;gap:10px}.tab-btn{background:0 0;border:2px solid transparent;padding:0.5rem 1.25rem;font-family:'Source Sans 3',sans-serif;font-size:0.75rem;font-weight:600;text-transform:uppercase;letter-spacing:0.03em;cursor:pointer;color:var(--text-muted);transition:var(--transition-smooth);border-radius:8px}.tab-btn:hover{color:var(--accent-warm);background:var(--bg-secondary)}.tab-btn.active{background:var(--bg-tertiary);color:var(--text-primary);border-color:var(--border-soft)}.tab-content{display:none;animation:fadeIn 0.5s ease-out}.tab-content.active{display:block}@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.controls-grid{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;margin-bottom:1.5rem}.control-group{background:var(--bg-secondary);padding:0.75rem 1rem;border-radius:10px;border:1px solid var(--border-soft)}label{font-family:'Source Sans 3',sans-serif;font-weight:600;display:block;margin-bottom:0.5rem;color:var(--accent-deep);font-size:0.8rem;letter-spacing:0.05em}input[type=number],input[type=text],select{width:100%;padding:0.6rem 0.75rem;border:2px solid var(--border-soft);border-radius:8px;background:var(--bg-primary);color:var(--text-primary);font-family:'Source Sans 3',sans-serif;font-size:1rem;box-sizing:border-box;transition:var(--transition-smooth)}input:focus,select:focus{outline:0;border-color:var(--accent-warm);box-shadow:0 0 0 3px rgba(227,4,18,0.15)}.q-slider-container{grid-column:span 2}input[type=range]{-webkit-appearance:none;width:100%;height:4px;background:var(--bg-tertiary);border-radius:2px;outline:0;margin:15px 0}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:18px;height:18px;background:var(--accent-warm);border-radius:50%;cursor:pointer;transition:var(--transition-smooth)}input[type=range]::-webkit-slider-thumb:hover{transform:scale(1.2)}.plot-wrapper{height:400px;width:100%;margin:2rem 0;background:#fff;border-radius:12px;padding:10px}.audio-controls{background:var(--bg-secondary);padding:1.5rem;border-radius:12px;display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;border:1px solid var(--border-soft);gap:20px}.play-btn{background:var(--accent-warm);color:#fff;border:none;padding:0.7rem 1.5rem;border-radius:8px;font-family:'Source Sans 3',sans-serif;font-size:0.75rem;font-weight:600;text-transform:uppercase;letter-spacing:0.03em;cursor:pointer;min-width:180px;transition:var(--transition-smooth);box-shadow:0 4px 12px rgba(227,4,18,0.2)}.play-btn:hover{background:var(--accent-earth);transform:translateY(-2px);box-shadow:0 4px 12px rgba(227,4,18,0.35)}.play-btn.playing{background-color:var(--accent-deep)}.param-row{display:flex;justify-content:space-between;align-items:center;gap:10px;margin-bottom:5px}.val-display{font-family:'Fraunces',serif;color:var(--accent-warm);font-size:1rem;font-weight:500}.check-container{display:inline-flex;align-items:center;gap:8px;cursor:pointer;font-weight:600;font-size:0.75rem;text-transform:uppercase;color:var(--text-secondary)}</style></head><body><div class="app-container"><h1>Procesos Espectrales</h1><p class="subtitle">Herramienta de Representación y Aplicación de Procesos Espectrales</p><div class="tabs"><button class="tab-btn active" id="btn-shelving" onclick="switchTab('shelving')">Ecualizador Shelving</button> <button class="tab-btn" id="btn-parametric" onclick="switchTab('parametric')">Ecualizador Paramétrico</button></div><div id="shelving" class="tab-content active"><div class="controls-grid"><div class="control-group"><label>Región del Espectro</label><select id="sh-type" onchange="updateShelving()"><option value="lowshelf">Low Shelf (Graves)</option><option value="highshelf">High Shelf (Agudos)</option></select></div><div class="control-group"><label>Ganancia: <span id="sh-gain-val" class="val-display">6 dB</span></label><input type="range" id="sh-gain" min="-15" max="15" step="1" value="6" oninput="updateShelving()"></div><div class="control-group"><label>Frec. Sugeridas</label><select id="sh-freq" onchange="updateShelving(!0)"><option value="40">40 Hz</option><option value="80">80 Hz</option><option value="160">160 Hz</option><option value="320" selected>320 Hz</option><option value="640">640 Hz</option><option value="1280">1.28 kHz</option><option value="2560">2.56 kHz</option><option value="5120">5.12 kHz</option><option value="10000">10 kHz</option><option value="15000">15 kHz</option></select></div><div class="control-group"><label>Ingreso por Teclado (Hz)</label><input type="number" id="sh-manual-freq" value="320" oninput="updateShelving(!1)"></div></div></div><div id="parametric" class="tab-content"><div class="controls-grid"><div class="control-group"><label>Frecuencia Central (Hz)</label><input type="number" id="peq-freq" value="1000" oninput="updateParametric()"></div><div class="control-group"><label>Ganancia (dB)</label><input type="number" id="peq-gain" value="-9" min="-24" max="24" step="1" oninput="updateParametric()"></div><div class="control-group q-slider-container"><div class="param-row"><label>Ancho de Banda (Factor Q / Octavas)</label><div><span id="peq-q-val" class="val-display" style="margin-right:15px">Q: 1.414</span> <input type="text" id="peq-bw-val" style="width:70px;display:inline-block;padding:2px 5px" oninput="updateParametricFromBW()"><span class="val-display" style="font-size:0.8rem">Oct</span></div></div><input type="range" id="peq-q" min="0.1" max="10" step="0.01" value="1.414" oninput="updateParametricFromQ()"></div></div></div><div class="plot-wrapper"><canvas id="filterChart"></canvas></div><div class="audio-controls"><button class="play-btn" id="audioBtn" onclick="toggleAudio()">Reproducir Señal de Control (Ruido)</button><div style="flex:1;min-width:200px"><label>Nivel de Monitoreo</label><input type="range" id="vol-slider" min="0" max="0.5" step="0.01" value="0.1" oninput="updateVolume()"></div><div><label class="check-container"><input type="checkbox" id="process-audio" checked onchange="toggleFilterBypass()"> Procesar</label></div></div></div><script>const ctx=document.getElementById('filterChart').getContext('2d');let chart,audioContext=null,sourceNode=null,filterNode=null,gainNode=null,isPlaying=!1,activeTab='shelving';function getLogFrequencyResponse(e,t,n){const o=[],a=44100;return n.forEach(n=>{const r=2*Math.PI*n/a,i=e[0]+e[1]*Math.cos(-r)+e[2]*Math.cos(-2*r),l=e[1]*Math.sin(-r)+e[2]*Math.sin(-2*r),c=t[0]+t[1]*Math.cos(-r)+t[2]*Math.cos(-2*r),s=t[1]*Math.sin(-r)+t[2]*Math.sin(-2*r);o.push(10*Math.log10((i**2+l**2)/(c**2+s**2)))}),o}function getShelvingCoeffs(e,t,n){const o=44100,a=Math.pow(10,t/40),r=2*Math.PI*e/o,i=Math.sin(r)/2*Math.sqrt((a+1/a)*(1/.707-1)+2),l=Math.cos(r);let c,s,u,d,g,m;return"lowshelf"===n?(c=a*((a+1)-(a-1)*l+2*Math.sqrt(a)*i),s=2*a*((a-1)-(a+1)*l),u=a*((a+1)-(a-1)*l-2*Math.sqrt(a)*i),d=(a+1)+(a-1)*l+2*Math.sqrt(a)*i,g=-2*((a-1)+(a+1)*l),m=(a+1)+(a-1)*l-2*Math.sqrt(a)*i):(c=a*((a+1)+(a-1)*l+2*Math.sqrt(a)*i),s=-2*a*((a-1)+(a+1)*l),u=a*((a+1)+(a-1)*l-2*Math.sqrt(a)*i),d=(a+1)-(a-1)*l+2*Math.sqrt(a)*i,g=2*((a-1)-(a+1)*l),m=(a+1)-(a-1)*l-2*Math.sqrt(a)*i),{b:[c/d,s/d,u/d],a:[1,g/d,m/d]}}function getPeakingCoeffs(e,t,n){const o=44100,a=Math.pow(10,t/40),r=2*Math.PI*e/o,i=Math.sin(r)/(2*n),l=Math.cos(r),c=1+i*a,s=-2*l,u=1-i*a,d=1+i/a,g=-2*l,m=1-i/a;return{b:[c/d,s/d,u/d],a:[1,g/d,m/d]}}function qToOctaves(e){return 2/Math.log(2)*Math.asinh(1/(2*e))}function octavesToQ(e){return 1/(2*Math.sinh(Math.log(2)/2*e))}function switchTab(e){document.querySelectorAll(".tab-btn").forEach(e=>e.classList.remove("active")),document.querySelectorAll(".tab-content").forEach(e=>e.classList.remove("active")),document.getElementById(`btn-${e}`).classList.add("active"),document.getElementById(e).classList.add("active"),activeTab=e,updateChart(),updateAudioFilter()}function updateShelving(e=!1){const t=document.getElementById("sh-freq"),n=document.getElementById("sh-manual-freq");e?n.value=t.value:t.value="",document.getElementById("sh-gain-val").innerText=document.getElementById("sh-gain").value+" dB",updateChart(),updateAudioFilter()}function updateParametricFromQ(){const e=parseFloat(document.getElementById("peq-q").value),t=qToOctaves(e);document.getElementById("peq-q-val").innerText="Q: "+e.toFixed(3),document.getElementById("peq-bw-val").value=t.toFixed(3),updateChart(),updateAudioFilter()}function updateParametricFromBW(){const e=parseFloat(document.getElementById("peq-bw-val").value);if(!isNaN(e)&&e>0){const t=octavesToQ(e);document.getElementById("peq-q").value=t,document.getElementById("peq-q-val").innerText="Q: "+t.toFixed(3),updateChart(),updateAudioFilter()}}function updateParametric(){updateChart(),updateAudioFilter()}function initChart(){const e=[],t=200,n=Math.log10(20),o=Math.log10(2e4);for(let a=0;a<t;a++)e.push(Math.pow(10,n+a/(t-1)*(o-n)));chart=new Chart(ctx,{type:"line",data:{labels:e,datasets:[]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{type:"logarithmic",title:{display:!0,text:"Frecuencia (Hz)",font:{family:"Source Sans 3",size:12,weight:600},color:"#5C5650"},min:20,max:2e4,ticks:{font:{family:"Source Sans 3",size:10},color:"#8A8279",callback:function(e){return[20,50,100,200,500,1e3,2e3,5e3,1e4,2e4].includes(e)?e>=1e3?e/1e3+"k":e:null}},grid:{color:"rgba(107, 91, 79, 0.1)"}},y:{title:{display:!0,text:"Ganancia (dB)",font:{family:"Source Sans 3",size:12,weight:600},color:"#5C5650"},suggestedMin:-15,suggestedMax:15,ticks:{font:{family:"Source Sans 3",size:11},color:"#8A8279"},grid:{color:"rgba(107, 91, 79, 0.1)"}}},plugins:{legend:{display:!1},tooltip:{backgroundColor:"#2D2A26",titleFont:{family:"Fraunces"},bodyFont:{family:"Source Sans 3"},callbacks:{title:e=>`${parseFloat(e[0].label).toFixed(0)} Hz`}}},elements:{point:{radius:0},line:{tension:.3}}}})}function updateChart(){if(!chart)return;const e=chart.data.labels;let t={};if("shelving"===activeTab){const n=document.getElementById("sh-type").value,o=parseFloat(document.getElementById("sh-gain").value),a=parseFloat(document.getElementById("sh-manual-freq").value);t=getShelvingCoeffs(a,o,n)}else{const n=parseFloat(document.getElementById("peq-freq").value),o=parseFloat(document.getElementById("peq-gain").value),a=parseFloat(document.getElementById("peq-q").value);t=getPeakingCoeffs(n,o,a)}const n=getLogFrequencyResponse(t.b,t.a,e);chart.data.datasets=[{label:"Respuesta",data:n,borderColor:"#E30412",borderWidth:3,fill:!0,backgroundColor:"rgba(227, 4, 18, 0.05)"}],chart.update("none"),window.currentCoeffs=t}function toggleAudio(){const e=document.getElementById("audioBtn");isPlaying?(stopAudio(),e.innerText="Reproducir Señal de Control (Ruido)",e.classList.remove("playing"),isPlaying=!1):(startAudio(),e.innerText="Detener Señal de Control (Ruido)",e.classList.add("playing"),isPlaying=!0)}function startAudio(){audioContext||(audioContext=new(window.AudioContext||window.webkitAudioContext)),"suspended"===audioContext.state&&audioContext.resume();const e=audioContext.sampleRate*2,t=audioContext.createBuffer(1,e,audioContext.sampleRate),n=t.getChannelData(0);for(let o=0;o<e;o++)n[o]=2*Math.random()-1;sourceNode=audioContext.createBufferSource(),sourceNode.buffer=t,sourceNode.loop=!0,filterNode=audioContext.createBiquadFilter(),gainNode=audioContext.createGain(),gainNode.gain.value=document.getElementById("vol-slider").value,updateAudioFilter(),document.getElementById("process-audio").checked?(sourceNode.connect(filterNode),filterNode.connect(gainNode)):sourceNode.connect(gainNode),gainNode.connect(audioContext.destination),sourceNode.start(0)}function stopAudio(){sourceNode&&(sourceNode.stop(),sourceNode.disconnect(),sourceNode=null)}function updateVolume(){gainNode&&(gainNode.gain.value=document.getElementById("vol-slider").value)}function updateAudioFilter(){isPlaying&&audioContext&&filterNode&&("shelving"===activeTab?(filterNode.type=document.getElementById("sh-type").value,filterNode.frequency.setValueAtTime(parseFloat(document.getElementById("sh-manual-freq").value),audioContext.currentTime),filterNode.gain.setValueAtTime(parseFloat(document.getElementById("sh-gain").value),audioContext.currentTime)):(filterNode.type="peaking",filterNode.frequency.setValueAtTime(parseFloat(document.getElementById("peq-freq").value),audioContext.currentTime),filterNode.gain.setValueAtTime(parseFloat(document.getElementById("peq-gain").value),audioContext.currentTime),filterNode.Q.setValueAtTime(parseFloat(document.getElementById("peq-q").value),audioContext.currentTime)))}function toggleFilterBypass(){isPlaying&&filterNode&&(sourceNode.disconnect(),filterNode.disconnect(),document.getElementById("process-audio").checked?(sourceNode.connect(filterNode),filterNode.connect(gainNode)):sourceNode.connect(gainNode))}initChart(),updateParametricFromQ();</script></body></html>